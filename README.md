# 1C-отбор на кафедру

- Поляков Геннадий, Б05-223
- Трек: Системное программирование-1

## Запуск проекта и описание

1. Установить GoLang [по ссылке](https://go.dev/doc/install).
2. Запустить `run.sh`, написав в консоли `./run.sh` внутри каждой директории.
3. Возможно из нескольких окон создавать клиентов и они будут работать независимо, не зная друг о друге.
4. Реализован весь функционал и требования из условия.

## Структура проекта

- `client/` - Директория с исходным кодом клиента.
- `server/` - Директория с исходным кодом сервера Эдди.
- `README.md` - Документация проекта.
- `run.sh` - Скрипт для запуска проекта(в каждой папке свой), для начала надо стартовать Server, потом Client
- Клиентов может быть сколь угодно много
- Сервер надо запускать в единственном экземпляре


## Endpoints сервиса(все примеры будут ниже)
- register - зарегестрировать нового клиента(игрока)
- suggest_game - Эдди предлагает игроку передающемуся через параметры сыграть(имя игры и имя игрока)
- history_step_by_name - узнать историю по имени игрока
- get_game_not_finished - узнать игры и имена игроков которые еще не закончили игру
- make_step - сделать шаг в переданной игре

## Endpoints клиентов:
- get_game - начать игру, служебная ручка для сервера, тк по условию только он начинает игру.
- steps - шаги в игре у текущего клиента
- do_step - сделать шаг текущим клиентом(в начале ждем сервер, пока он придет к нам с запросами)

## Пример игры:(в хронологическом порядке)
(уже стартовал сервис и player с именем 1 зарегестрировался), если что все редачится в json config
1) curl "http://localhost:8080/suggest_game?game=1&player=1" ; в данном случае мы называем игру номер 1 и предлагаем в нее сыграть
    * тут надо ввести хотим ли мы делать вторыми шаг(1 - будем вторыми, 0 первыми ходить)
    * здесь на сторону клиента приходит запрос что мы хотим с ним играть и каким будет ходить клиент
       * здесь клиент выбирает хочет ли он с нами играть(1 - да, хочет, 0 - иначе)
       * далее вводится ход игрока, если мы выбрали что в этой игре игрок ходит первым, а мы вторыми(ход во всей игре это числа от 1 до 3 по вертикали и горизонтали поля для игры в крестики нолики)
       * если мы ходим первыми, то возвращаем наш ход и теперь состояние игры консистентно.
    * со стороны клиенты пришел ответ, и если он ходил первым, то мы изменяем состояние игры на сервере(те теперь у игроков одинаковое состояние)
2) curl "http://localhost:8080/make_step?game=1" ; теперь если мы хотим играть в игру, то Эдди ходит, здесь так же мы обязательно должны указать название игры и дальше в консоль ввести координаты куда сходить, если так сходить не удастся или игра завершена - вернется соответсвующий ответ(или игры вообще не существовала)
    * в данном случае внутри этого хода отправляется запрос игроку - клиенту, который также в консоли вводит куда поставить свой значок через консоль
3) повторяем шаг два возможно с различными играми, также мы можем вывести остальные части из условия задания.
4) curl "http://localhost:8081/steps", где localhost:8081 - просто пример адреса клиента на котором запущена определенная игра - вернет все шаги по игре с этим игроком
5) curl "http://localhost:8080/history_step_by_name?player=1"; возвращает по имени игрока(player=<name_client>) уже сыгранные с ним игры(по умолчанию там null)
6) curl "http://localhost:8080/get_game_not_finished" - возвращает имена игр и имена игроков в формате `[{"game_name":"1","player_name":"1"}]` , которые еще не завершены, чтобы у нас была возможность выбрать.

## Алгоритм проекта

1. Клиент отправляет запрос на сервер для регистрации игрока(автоматически при старте)
2. Сервер обрабатывает запрос и регистрирует игрока.
3. Сервер отправляет запрос на сервер для начала игры.
4. Сервер обрабатывает запрос и начинает игру.
5. Сервер и клиент отправляет запросы на сервер для выполнения шагов в игре.
6. Сервер и клиент обрабатывает запросы и обновляет состояние игры.
7. Игра продолжается до тех пор, пока не будет достигнуто конечное состояние (победа одного из игроков или ничья).

## Возможности сервера

- Регистрация игроков.
- Начало игры.
- Обработка шагов игроков.
- Отслеживание состояния игры.
- Завершение игры.
- крутится на порту 8080 на localhost, но решение можно масштабировать и засунуть все в конфиг, не успевал просто.

## Возможности клиента

- Регистрация на сервере.
- Начало игры или отказ от нее, решение принимается человеком через консоль.
- Отправка шагов на сервер.
- Получение состояния игры.
- Завершение игры.
- имя игрока, порт на котором крутится и адрес Эдди задается через конфиг.
